From a608bba3d392267bc4fb5402c31c7ff2d2ac1e21 Mon Sep 17 00:00:00 2001
From: Ryan Gonzalez <git@refi64.dev>
Date: Wed, 13 Sep 2023 09:31:07 -0500
Subject: [PATCH] Clang build script: add support for building a subset of
 target triples

---
 tools/clang/scripts/build.py | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/tools/clang/scripts/build.py b/tools/clang/scripts/build.py
index cddb46267ead6..c242fa48514cf 100755
--- a/tools/clang/scripts/build.py
+++ b/tools/clang/scripts/build.py
@@ -615,6 +615,8 @@ def main():
   parser.add_argument('--bootstrap',
                       action='store_true',
                       help='first build clang with CC, then with itself.')
+  parser.add_argument('--target-triple', action='append', dest='target_triples',
+                      help='Only build support for the given triples')
   parser.add_argument('--disable-asserts', action='store_true',
                       help='build with asserts disabled')
   parser.add_argument('--host-cc',
@@ -1390,6 +1392,8 @@ def main():
   # -DLLVM_BUILTIN_TARGETS/-DLLVM_RUNTIME_TARGETS.
   all_triples = ''
   for triple in sorted(runtimes_triples_args.keys()):
+    if args.target_triples and triple not in args.target_triples:
+      continue
     all_triples += triple + ';'
     for arg in runtimes_triples_args[triple]["args"]:
       assert not arg.startswith('-')
-- 
2.46.0

