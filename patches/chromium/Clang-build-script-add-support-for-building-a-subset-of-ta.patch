From 0855851c5bde9c98f613b763002af30e2b3599bb Mon Sep 17 00:00:00 2001
From: Ryan Gonzalez <git@refi64.dev>
Date: Wed, 13 Sep 2023 09:31:07 -0500
Subject: [PATCH] Clang build script: add support for building a subset of
 target triples

---
 tools/clang/scripts/build.py | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/tools/clang/scripts/build.py b/tools/clang/scripts/build.py
index a7e106a8d9a0f..c5b861f40eba6 100755
--- a/tools/clang/scripts/build.py
+++ b/tools/clang/scripts/build.py
@@ -686,6 +686,8 @@ def main():
   parser.add_argument('--bootstrap',
                       action='store_true',
                       help='first build clang with CC, then with itself.')
+  parser.add_argument('--target-triple', action='append', dest='target_triples',
+                      help='Only build support for the given triples')
   parser.add_argument('--disable-asserts', action='store_true',
                       help='build with asserts disabled')
   parser.add_argument('--host-cc',
@@ -1516,6 +1518,8 @@ def main():
   # -DLLVM_BUILTIN_TARGETS/-DLLVM_RUNTIME_TARGETS.
   all_triples = ''
   for triple in sorted(runtimes_triples_args.keys()):
+    if args.target_triples and triple not in args.target_triples:
+      continue
     all_triples += triple + ';'
     for arg in runtimes_triples_args[triple]["args"]:
       assert not arg.startswith('-')
-- 
2.49.0

